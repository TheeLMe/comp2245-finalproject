<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Contact Details</title>
    <link rel="stylesheet" href="assets/CSS/contact_detailsstyles.css">
</head>

<body>

<header>
    <img src="assets/Images/dolphin.png" class="logo" alt="Logo">
    <h1>Dolphin CRM</h1>
</header>

<main>
    <aside class="sidebar">
        <a href="dashboard.php">Home</a>
        <a href="new_contact.php">New Contact</a>
        <a href="users.php">Users</a>

        <div id="lgnav">
            <a href="logout.php">Logout</a>
        </div>
    </aside>

    <section class="content">
        <div class="contact-card">

            <h2 class="section-title">Contact Details</h2>

            <!-- CONTACT INFO -->
            <div class="info-grid">
                <div class="info-item">
                    <span class="label">Title</span>
                    <span class="value"><?= htmlspecialchars($contact['title']) ?></span>
                </div>

                <div class="info-item">
                    <span class="label">Full Name</span>
                    <span class="value">
                        <?= htmlspecialchars($contact['firstname'] . " " . $contact['lastname']) ?>
                    </span>
                </div>

                <div class="info-item">
                    <span class="label">Email</span>
                    <span class="value"><?= htmlspecialchars($contact['email']) ?></span>
                </div>

                <div class="info-item">
                    <span class="label">Company</span>
                    <span class="value"><?= htmlspecialchars($contact['company']) ?></span>
                </div>

                <div class="info-item">
                    <span class="label">Telephone</span>
                    <span class="value"><?= htmlspecialchars($contact['telephone']) ?></span>
                </div>

                <div class="info-item">
                    <span class="label">Assigned To</span>
                    <span class="value"><?= htmlspecialchars($assignedUserName) ?></span>
                </div>

                <div class="info-item">
                    <span class="label">Created</span>
                    <span class="value"><?= htmlspecialchars($contact['created_at']) ?></span>
                </div>

                <div class="info-item">
                    <span class="label">Last Updated</span>
                    <span class="value"><?= htmlspecialchars($contact['updated_at']) ?></span>
                </div>
            </div>

            <!-- ACTIONS -->
            <div class="btn-row">
                <form method="POST">
                    <button name="assign" class="btn assign-btn">Assign to Me</button>
                </form>

                <form method="POST">
                    <select name="type" class="type-select" onchange="this.form.submit()">
                        <option value="Sales Lead" <?= $contact["type"]=="Sales Lead" ? "selected" : "" ?>>Sales Lead</option>
                        <option value="Support" <?= $contact["type"]=="Support" ? "selected" : "" ?>>Support</option>
                        <option value="Sales" <?= $contact["type"]=="Sales" ? "selected" : "" ?>>Sales</option>
                    </select>
                </form>
            </div>

            <!-- NOTES -->
            <div class="notes-section">
                <h3 class="section-title">Notes</h3>

                <?php foreach ($notes as $note): ?>
                    <div class="note">
                        <div class="note-meta">
                            By <?= htmlspecialchars($note["firstname"] . " " . $note["lastname"]) ?>
                            â€” <?= htmlspecialchars($note["created_at"]) ?>
                        </div>
                        <div><?= htmlspecialchars($note["comment"]) ?></div>
                    </div>
                <?php endforeach; ?>

                <!-- ADD NOTE -->
                <form method="POST" class="add-note">
                    <textarea name="note" placeholder="Write a new note..."></textarea>
                    <button class="save-note-btn">Add Note</button>
                </form>
            </div>

        </div>
    </section>
</main>

</body>
</html>
