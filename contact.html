<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Contact Details</title>

    <!-- Your CSS -->
    <link rel="stylesheet" href="assets/CSS/contact_detailsstyles.css">

    <!-- Font Awesome (needed for icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>

<header class="Title">
    <img src="assets/Images/dolphin.png" class="logo" alt="Logo">
    Dolphin CRM
</header>

<main>
    <!-- SIDEBAR -->
    <aside class="sidebar">
        <a href="dashboard.php"><i class="fas fa-home"></i> Home</a>
        <a href="new_contact.php"><i class="fas fa-user-plus"></i> New Contact</a>
        <a href="Users.html"><i class="fas fa-users"></i> Users</a>
        <hr class="sidebar-divider">
        <a href="logout.php"><i class="fas fa-sign-out-alt"></i> Logout</a>
    </aside>

    <!-- CONTENT -->
    <section class="content">
        <div class="contact-card">

            <h2 class="section-title">Contact Details</h2>

            <div class="info-grid">
                <div class="info-item">
                    <span class="label">Title</span>
                    <span class="value"><?= htmlspecialchars($contact['title']) ?></span>
                </div>

                <div class="info-item">
                    <span class="label">Full Name</span>
                    <span class="value">
                        <?= htmlspecialchars($contact['firstname'] . " " . $contact['lastname']) ?>
                    </span>
                </div>

                <div class="info-item">
                    <span class="label">Email</span>
                    <span class="value"><?= htmlspecialchars($contact['email']) ?></span>
                </div>

                <div class="info-item">
                    <span class="label">Company</span>
                    <span class="value"><?= htmlspecialchars($contact['company']) ?></span>
                </div>

                <div class="info-item">
                    <span class="label">Telephone</span>
                    <span class="value"><?= htmlspecialchars($contact['telephone']) ?></span>
                </div>

                <div class="info-item">
                    <span class="label">Assigned To</span>
                    <span class="value"><?= htmlspecialchars($assignedUserName) ?></span>
                </div>

                <div class="info-item">
                    <span class="label">Created</span>
                    <span class="value"><?= htmlspecialchars($contact['created_at']) ?></span>
                </div>

                <div class="info-item">
                    <span class="label">Last Updated</span>
                    <span class="value"><?= htmlspecialchars($contact['updated_at']) ?></span>
                </div>
            </div>

            <!-- ACTIONS -->
            <div class="btn-row">
                <form method="POST">
                    <button name="assign" class="btn assign-btn">Assign to Me</button>
                </form>

                <form method="POST">
                    <select name="type" class="type-select" onchange="this.form.submit()">
                        <option value="Sales Lead" <?= $contact["type"]=="Sales Lead" ? "selected" : "" ?>>Sales Lead</option>
                        <option value="Support" <?= $contact["type"]=="Support" ? "selected" : "" ?>>Support</option>
                        <option value="Sales" <?= $contact["type"]=="Sales" ? "selected" : "" ?>>Sales</option>
                    </select>
                </form>
            </div>

            <!-- NOTES -->
            <div class="notes-section">
                <h3 class="section-title">Notes</h3>

                <?php foreach ($notes as $note): ?>
                    <div class="note">
                        <div class="note-meta">
                            By <?= htmlspecialchars($note["firstname"] . " " . $note["lastname"]) ?>
                            â€” <?= htmlspecialchars($note["created_at"]) ?>
                        </div>
                        <div><?= htmlspecialchars($note["comment"]) ?></div>
                    </div>
                <?php endforeach; ?>

                <!-- ADD NOTE -->
                <form method="POST" class="add-note">
                    <textarea name="note" placeholder="Write a new note..."></textarea>
                    <button class="save-note-btn">Add Note</button>
                </form>
            </div>

        </div>
    </section>
</main>

</body>
</html>
